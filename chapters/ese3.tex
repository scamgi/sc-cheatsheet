%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% chapters/ese3.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Esercizio 3: Processi Casuali Stazionari}
\addcontentsline{toc}{chapter}{Esercizio 3: Processi Casuali Stazionari}

\section{Strategia Generale}
L'esercizio 3 riguarda i processi casuali, le loro statistiche (media, varianza, autocorrelazione, DSP) e come queste vengono modificate da un sistema LTI o da altre operazioni. La chiave è saper passare da un dominio all'altro (tempo/frequenza, statistico/deterministico) usando le relazioni corrette.

\subsection{A) Calcolo di Statistiche e Parametri del Processo}
Il primo passo è quasi sempre determinare le statistiche fondamentali del processo: valor medio ($m_x$), varianza ($\sigma_x^2$), potenza ($P_x$).

\subsubsection{Relazioni Fondamentali}
Ricorda sempre queste relazioni chiave:
\begin{itemize}
    \item \textbf{Potenza, Varianza e Media:} $P_x = \sigma_x^2 + m_x^2$. La potenza è il valore quadratico medio $E[x_n^2]$.
    \item \textbf{Autocorrelazione e Autocovarianza:} $R_x[m] = C_x[m] + m_x^2$.
    \item \textbf{Potenza e Autocorrelazione:} La potenza è l'autocorrelazione calcolata in zero: $P_x = R_x[0]$.
    \item \textbf{Potenza e DSP:} La potenza è l'integrale della Densità Spettrale di Potenza (DSP): $P_x = \int_{-1/2}^{1/2} S_x(\varphi) d\varphi$.
\end{itemize}

\subsubsection{Come Trovare le Statistiche}
I dati iniziali possono essere forniti in forme diverse.

\paragraph{1. Dalla Densità di Probabilità (PDF) $p_x(a)$:}
Se viene fornita la forma della PDF (es. uniforme, gaussiana, discreta):
\begin{itemize}
    \item \textbf{Valor Medio:} $m_x = E[x] = \int_{-\infty}^{\infty} a \cdot p_x(a) da$.
    \item \textbf{Potenza (Valor Quadratico Medio):} $P_x = E[x^2] = \int_{-\infty}^{\infty} a^2 \cdot p_x(a) da$.
    \item \textbf{Varianza:} $\sigma_x^2 = P_x - m_x^2$.
    \item \textbf{Caso Uniforme} su $[a, b]$: $m_x = \frac{a+b}{2}$, $\sigma_x^2 = \frac{(b-a)^2}{12}$.
\end{itemize}

\paragraph{2. Dalla Densità Spettrale di Potenza (DSP) $S_x(\varphi)$:}
La DSP è la Trasformata di Fourier dell'autocorrelazione (Teorema di Wiener-Khinchin).
\begin{itemize}
    \item \textbf{Valor Medio al Quadrato ($m_x^2$):} È il coefficiente dell'impulso di Dirac $\delta(\varphi)$ centrato in frequenza zero. Se non c'è l'impulso, il processo è a media nulla.
    \item \textbf{Varianza ($\sigma_x^2$):} È l'area (integrale) della parte continua della DSP: $\sigma_x^2 = \int_{-1/2}^{1/2} (S_x(\varphi) - m_x^2\delta(\varphi)) d\varphi$.
\end{itemize}

\paragraph{3. Dall'Autocorrelazione $R_x[m]$:}
\begin{itemize}
    \item \textbf{Potenza:} $P_x = R_x[0]$.
    \item \textbf{Valor Medio al Quadrato:} Se il processo è ergodico, $m_x^2 = \lim_{m \to \infty} R_x[m]$.
    \item \textbf{Varianza:} $\sigma_x^2 = R_x[0] - m_x^2 = C_x[0]$.
\end{itemize}

\paragraph{4. Da Dati Aggiuntivi (per trovare parametri incogniti):}
Spesso vengono forniti $R_x[m]$ o $S_x(f)$ con parametri incogniti (es. $R_x[m] = A\delta_m + B\delta_{m\pm1}$). Per trovarli, si crea un sistema di equazioni usando le informazioni date, come:
\begin{itemize}
    \item I valori noti di $m_x, \sigma_x^2, P_x$.
    \item La potenza di una combinazione lineare di campioni, es. $E[(x_n+x_{n-1})^2] = 2R_x[0] + 2R_x[1]$.
\end{itemize}

\subsection{B) Filtraggio di Processi Casuali}
Quando un processo $x_n$ passa attraverso un filtro LTI con risposta $h_n$ (e risposta in frequenza $H(\varphi)$), si ottiene un processo $y_n$.

\subsubsection{Formule Generali di Filtraggio}
\begin{itemize}
    \item \textbf{DSP di uscita:} È la formula più comune e potente.
    $$ S_y(\varphi) = S_x(\varphi) \cdot |H(\varphi)|^2 $$
    \item \textbf{Autocorrelazione di uscita:} Tramite IFT della DSP o convoluzione.
    $$ R_y[m] = \IFT\{S_y(\varphi)\} = R_x[m] * h[m] * h[-m] $$
    dove $h[-m]$ è la risposta coniugata e invertita nel tempo.
    \item \textbf{Cross-correlazione ingresso-uscita:}
    $$ R_{yx}[m] = E[y_{n+m}x_n] = R_x[m] * h[m] $$
    $$ S_{yx}(\varphi) = S_x(\varphi)H(\varphi) $$
    \item \textbf{Valor Medio di uscita:}
    $$ m_y = m_x \cdot H(0) = m_x \cdot \sum_{k=-\infty}^{\infty} h_k $$
    \item \textbf{Potenza di uscita:}
    $$ P_y = R_y[0] = \int_{-1/2}^{1/2} S_y(\varphi) d\varphi $$
\end{itemize}

\subsubsection{Caso Speciale: Filtraggio di Rumore Bianco}
Se il processo in ingresso $x_n$ è \textbf{bianco} (incorrelato), i calcoli si semplificano enormemente.
Ricorda che per un processo bianco $R_x[m] = \sigma_x^2\delta_m + m_x^2$ e $S_x(\varphi) = \sigma_x^2 + m_x^2\delta(\varphi)$.
\begin{itemize}
    \item \textbf{Varianza di uscita:} La varianza in uscita è la somma pesata della varianza in ingresso.
    $$ \sigma_y^2 = \sigma_x^2 \cdot \sum_{k=-\infty}^{\infty} |h_k|^2 $$
    \item \textbf{Potenza di uscita:} Si può calcolare come $\sigma_y^2 + m_y^2$.
    $$ P_y = \sigma_x^2 \sum |h_k|^2 + (m_x \sum h_k)^2 $$
\end{itemize}
Questa scorciatoia è molto utile quando $h_n$ è una sequenza FIR corta (es. $h_n = \delta_n + \delta_{n-1}$).

\subsubsection{Esempio Comune: Filtri Differenza}
Operazioni come $y_n = x_n - x_{n-k}$ sono un filtraggio LTI.
\begin{itemize}
    \item \textbf{Risposta all'impulso:} $h_n = \delta_n - \delta_{n-k}$.
    \item \textbf{Risposta in frequenza:} $H(\varphi) = 1 - e^{-j2\pi k\varphi}$.
    \item \textbf{Modulo quadro:} $|H(\varphi)|^2 = |1 - e^{-j2\pi k\varphi}|^2 = (1 - \cos(2\pi k\varphi))^2 + \sin^2(2\pi k\varphi) = 2 - 2\cos(2\pi k\varphi)$.
    \item \textbf{DSP di uscita:} $S_y(\varphi) = S_x(\varphi) \cdot [2 - 2\cos(2\pi k\varphi)]$.
\end{itemize}

\subsection{C) Domande Concettuali e Proprietà Utili}
\begin{itemize}
    \item \textbf{Positività della DSP:} La densità spettrale di potenza non può mai essere negativa: $S_x(\varphi) \ge 0$ per ogni $\varphi$. Questa proprietà è fondamentale per trovare i limiti di un parametro incognito.
    Esempio: se $S_x(\varphi) = 4 + A\cos(2\pi \varphi)$, allora si deve avere $|A| \le 4$.
    
    \item \textbf{Processo Bianco:} Un processo è bianco se i suoi campioni sono incorrelati.
    \begin{itemize}
        \item Autocovarianza: $C_x[m] = \sigma_x^2 \delta_m$.
        \item Autocorrelazione: $R_x[m] = \sigma_x^2 \delta_m + m_x^2$.
        \item DSP: $S_x(\varphi) = \sigma_x^2 + m_x^2 \delta(\varphi)$ (costante + impulso in zero).
    \end{itemize}
    
    \item \textbf{Varianza di somme di campioni:} La varianza di una somma non è la somma delle varianze, a meno che i campioni non siano incorrelati.
    $ Var(y_n) = E[y_n^2] - m_y^2 $. Se $y_n = ax_n + bx_{n-k}$:
    \begin{itemize}
        \item $m_y = (a+b)m_x$.
        \item $E[y_n^2] = E[(ax_n + bx_{n-k})^2] = a^2R_x[0] + b^2R_x[0] + 2abR_x[k]$.
    \end{itemize}

    \item \textbf{Operazioni non lineari:} Se un processo subisce una trasformazione non lineare (es. $z_n = |x_n|$ o un rettificatore), la sua PDF cambia. Per trovare media e varianza di $z_n$, si deve prima calcolare la nuova PDF $p_z(a)$ e poi usare le definizioni integrali.
\end{itemize}
